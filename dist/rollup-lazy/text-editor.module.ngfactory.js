"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __chunk1_js=require("./chunk1.js"),__chunk7_js=require("./chunk7.js"),__chunk5_js=require("./chunk5.js"),__chunk8_js=require("./chunk8.js"),__extends=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},toString=Object.prototype.toString;function isNodeStyleEventEmitter(e){return!!e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}function isJQueryStyleEventEmitter(e){return!!e&&"function"==typeof e.on&&"function"==typeof e.off}function isNodeList(e){return!!e&&"[object NodeList]"===toString.call(e)}function isHTMLCollection(e){return!!e&&"[object HTMLCollection]"===toString.call(e)}function isEventTarget(e){return!!e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}var FromEventObservable=function(e){__extends(t,e);function t(t,n,r,c){e.call(this),this.sourceObj=t,this.eventName=n,this.selector=r,this.options=c}return t.create=function(e,n,r,c){return __chunk1_js.isFunction(r)&&(c=r,r=void 0),new t(e,n,c,r)},t.setupSubscription=function(e,n,r,c,o){var i;if(isNodeList(e)||isHTMLCollection(e))for(var s=0,u=e.length;s<u;s++)t.setupSubscription(e[s],n,r,c,o);else if(isEventTarget(e)){var l=e;e.addEventListener(n,r,o),i=function(){return l.removeEventListener(n,r)}}else if(isJQueryStyleEventEmitter(e)){var a=e;e.on(n,r),i=function(){return a.off(n,r)}}else{if(!isNodeStyleEventEmitter(e))throw new TypeError("Invalid event target");var h=e;e.addListener(n,r),i=function(){return h.removeListener(n,r)}}c.add(new __chunk1_js.Subscription(i))},t.prototype._subscribe=function(e){var n=this.sourceObj,r=this.eventName,c=this.options,o=this.selector,i=o?function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];var r=__chunk1_js.tryCatch(o).apply(void 0,t);r===__chunk1_js.errorObject?e.error(__chunk1_js.errorObject.e):e.next(r)}:function(t){return e.next(t)};t.setupSubscription(n,r,i,e,c)},t}(__chunk1_js.Observable),fromEvent=FromEventObservable.create;__chunk1_js.Observable.fromEvent=fromEvent,__chunk1_js.Observable.prototype.filter=__chunk1_js.filter;var __extends$1=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};function takeUntil(e){return function(t){return t.lift(new TakeUntilOperator(e))}}var TakeUntilOperator=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){return t.subscribe(new TakeUntilSubscriber(e,this.notifier))},e}(),TakeUntilSubscriber=function(e){__extends$1(t,e);function t(t,n){e.call(this,t),this.notifier=n,this.add(__chunk1_js.subscribeToResult(this,n))}return t.prototype.notifyNext=function(e,t,n,r,c){this.complete()},t.prototype.notifyComplete=function(){},t}(__chunk1_js.OuterSubscriber);function takeUntil$1(e){return takeUntil(e)(this)}__chunk1_js.Observable.prototype.takeUntil=takeUntil$1;var __extends$2=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};function repeat(e){return void 0===e&&(e=-1),function(t){return 0===e?new __chunk1_js.EmptyObservable:e<0?t.lift(new RepeatOperator(-1,t)):t.lift(new RepeatOperator(e-1,t))}}var RepeatOperator=function(){function e(e,t){this.count=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new RepeatSubscriber(e,this.count,this.source))},e}(),RepeatSubscriber=function(e){__extends$2(t,e);function t(t,n,r){e.call(this,t),this.count=n,this.source=r}return t.prototype.complete=function(){if(!this.isStopped){var t=this.source,n=this.count;if(0===n)return e.prototype.complete.call(this);n>-1&&(this.count=n-1),t.subscribe(this._unsubscribeAndRecycle())}},t}(__chunk1_js.Subscriber);function repeat$1(e){return void 0===e&&(e=-1),repeat(e)(this)}__chunk1_js.Observable.prototype.repeat=repeat$1;var KeyMap=function(){function e(){}return e.spaceBar=32,e.enter=13,e.a=65,e.z=90,e.backSpace=8,e.zero=48,e.nine=57,e}(),Character=function(){return function(e){this.isCurrent=!1,this.lineBreak=!1,this.placeHolder=!1,this.deleteChar=!1,this.isSelected=!1,e===KeyMap.enter?(this.value="\n",this.lineBreak=!0):-1===e?(this.value="",this.placeHolder=!0):e===KeyMap.backSpace?this.deleteChar=!0:this.value=String.fromCharCode(e).toLowerCase()}}(),Document=function(){function e(){this.characters=[],this.firstSelectedCharacter=-1,this.currentChar=new Character(-1),this.characters.push(this.currentChar),this.characters[0].isCurrent=!0}return e.prototype.deselectPreviousCharacter=function(){if(this.currentChar){var e=this.characters.indexOf(this.currentChar);this.characters[e].isCurrent=!1}},e.prototype.clearSelection=function(e){this.firstSelectedCharacter=-1,e&&(this.firstSelectedCharacter=this.characters.indexOf(e.character)),this.characters.forEach(function(e){return e.isSelected=!1})},e.prototype.edit=function(e,t){if(e.deleteChar){var n=this.characters.indexOf(this.currentChar);n>=1&&(this.characters.splice(n,1),this.characters.length>1?(this.characters[n-1].isCurrent=!0,this.currentChar=this.characters[n-1]):1===this.characters.length&&(this.characters[0].isCurrent=!0,this.currentChar=this.characters[0]))}else if(this.characters.splice(t,0,e),e.lineBreak){this.deselectPreviousCharacter();var r=new Character(-1);this.characters.splice(t+1,0,r),this.placeCursor(r)}else this.placeCursor(e)},e.prototype.placeCursor=function(e){this.deselectPreviousCharacter();var t=this.characters.indexOf(e);this.characters[t].isCurrent=!0,this.currentChar=e},e.prototype.selectCharacter=function(e){for(var t=this.characters.indexOf(e),n=this.firstSelectedCharacter;n<=t;n++)this.characters[n].isSelected=!0},e.prototype.processInput=function(e,t){if("modify"===t){var n=this.characters.indexOf(this.currentChar);n<0&&(n=this.characters.length-1),this.edit(e,n+1)}"select"===t&&this.placeCursor(e),"range"===t&&this.selectCharacter(e)},e}(),TextEditor=function(){function e(){this.currentDocument=new Document}return e.prototype.isSuportedCharacter=function(e){return e>=KeyMap.a&&e<KeyMap.z||(e===KeyMap.enter||e===KeyMap.spaceBar||e===KeyMap.backSpace||e>=KeyMap.zero&&e<=KeyMap.nine)},e.prototype.getCharacterFromElement=function(e,t){var n=[].slice.call(this.editor.children).indexOf(e.target);return n>=0?{operation:t,character:this.currentDocument.characters[n],element:e}:null},e.prototype.ngOnInit=function(){var e=this;this.editor=document.getElementById("page"),this.keyUp=__chunk1_js.Observable.fromEvent(document,"keyup").filter(function(t){return e.isSuportedCharacter(t.which)}).map(function(e){return{operation:"modify",character:new Character(e.which),element:e}}),this.mouseDown=__chunk1_js.Observable.fromEvent(this.editor,"mousedown").do(function(t){return e.currentDocument.clearSelection(e.getCharacterFromElement(t,"range"))}).flatMap(function(t){return __chunk1_js.Observable.fromEvent(e.editor,"mousemove")}).map(function(t){return e.getCharacterFromElement(t,"range")}).filter(function(e){return null!==e}).takeUntil(__chunk1_js.Observable.fromEvent(this.editor,"mouseup")).repeat(),this.click=__chunk1_js.Observable.fromEvent(this.editor,"click").map(function(t){return e.getCharacterFromElement(t,"select")}).filter(function(e){return null!==e}),this.keyDown=__chunk1_js.Observable.fromEvent(document,"keydown").filter(function(e){return e.which===KeyMap.spaceBar||e.which===KeyMap.backSpace}).map(function(e){return{element:e}}),this.keyUp.merge(this.click).merge(this.mouseDown).merge(this.keyDown).subscribe(function(t){e.currentDocument.processInput(t.character,t.operation),t.element.preventDefault()})},e.decorators=[{type:__chunk1_js.Component,args:[{selector:"editor",template:'\n    \n  <h1>Text editor based on Observables</h1>\n\n  <div class="alert alert-success" role="alert">\n      Supports typing of letters and numbers. Basic text selection and cursor placement is also supported.\n  </div>\n\n  <div class="editor">\n  <div class="page noselect" id="page"><span *ngFor="let char of currentDocument.characters" [ngClass]="{currentChar:char.isCurrent,selectedChar:char.isSelected}">{{char.value}}</span></div>\n  </div>\n\n  <h4><a href="http://www.syntaxsuccess.com/viewarticle/observables-in-angular-2.0">Read more here</a></h4>'}]}],e.ctorParameters=function(){return[]},e}(),TextEditorModule=function(){function e(){}return e.decorators=[{type:__chunk1_js.NgModule,args:[{declarations:[TextEditor],imports:[__chunk1_js.CommonModule,__chunk1_js.RouterModule.forChild([{path:"",component:TextEditor}])]}]}],e.ctorParameters=function(){return[]},e}(),styles_TextEditor=[],RenderType_TextEditor=__chunk1_js.createRendererType2({encapsulation:2,styles:styles_TextEditor,data:{}});function View_TextEditor_1(e){return __chunk1_js.viewDef(0,[(e()(),__chunk1_js.elementDef(0,0,null,null,3,"span",[],null,null,null,null,null)),__chunk1_js.directiveDef(1,278528,null,0,__chunk1_js.NgClass,[__chunk1_js.IterableDiffers,__chunk1_js.KeyValueDiffers,__chunk1_js.ElementRef,__chunk1_js.Renderer2],{ngClass:[0,"ngClass"]},null),__chunk1_js.pureObjectDef(2,{currentChar:0,selectedChar:1}),(e()(),__chunk1_js.textDef(3,null,["",""]))],function(e,t){e(t,1,0,e(t,2,0,t.context.$implicit.isCurrent,t.context.$implicit.isSelected))},function(e,t){e(t,3,0,t.context.$implicit.value)})}function View_TextEditor_0(e){return __chunk1_js.viewDef(0,[(e()(),__chunk1_js.elementDef(0,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),__chunk1_js.textDef(-1,null,["Text editor based on Observables"])),(e()(),__chunk1_js.elementDef(2,0,null,null,1,"div",[["class","alert alert-success"],["role","alert"]],null,null,null,null,null)),(e()(),__chunk1_js.textDef(-1,null,[" Supports typing of letters and numbers. Basic text selection and cursor placement is also supported. "])),(e()(),__chunk1_js.elementDef(4,0,null,null,3,"div",[["class","editor"]],null,null,null,null,null)),(e()(),__chunk1_js.elementDef(5,0,null,null,2,"div",[["class","page noselect"],["id","page"]],null,null,null,null,null)),(e()(),__chunk1_js.anchorDef(16777216,null,null,1,null,View_TextEditor_1)),__chunk1_js.directiveDef(7,802816,null,0,__chunk1_js.NgForOf,[__chunk1_js.ViewContainerRef,__chunk1_js.TemplateRef,__chunk1_js.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),__chunk1_js.elementDef(8,0,null,null,2,"h4",[],null,null,null,null,null)),(e()(),__chunk1_js.elementDef(9,0,null,null,1,"a",[["href","http://www.syntaxsuccess.com/viewarticle/observables-in-angular-2.0"]],null,null,null,null,null)),(e()(),__chunk1_js.textDef(-1,null,["Read more here"]))],function(e,t){e(t,7,0,t.component.currentDocument.characters)},null)}function View_TextEditor_Host_0(e){return __chunk1_js.viewDef(0,[(e()(),__chunk1_js.elementDef(0,0,null,null,1,"editor",[],null,null,null,View_TextEditor_0,RenderType_TextEditor)),__chunk1_js.directiveDef(1,114688,null,0,TextEditor,[],null,null)],function(e,t){e(t,1,0)},null)}var TextEditorNgFactory=__chunk1_js.createComponentFactory("editor",TextEditor,View_TextEditor_Host_0,{},{},[]),TextEditorModuleNgFactory=__chunk1_js.createNgModuleFactory(TextEditorModule,[],function(e){return __chunk1_js.moduleDef([__chunk1_js.moduleProvideDef(512,__chunk1_js.ComponentFactoryResolver,__chunk1_js.CodegenComponentFactoryResolver,[[8,[TextEditorNgFactory]],[3,__chunk1_js.ComponentFactoryResolver],__chunk1_js.NgModuleRef]),__chunk1_js.moduleProvideDef(4608,__chunk1_js.NgLocalization,__chunk1_js.NgLocaleLocalization,[__chunk1_js.LOCALE_ID,[2,__chunk1_js.DEPRECATED_PLURAL_FN]]),__chunk1_js.moduleProvideDef(512,__chunk1_js.CommonModule,__chunk1_js.CommonModule,[]),__chunk1_js.moduleProvideDef(512,__chunk1_js.RouterModule,__chunk1_js.RouterModule,[[2,__chunk1_js.ROUTER_FORROOT_GUARD],[2,__chunk1_js.Router]]),__chunk1_js.moduleProvideDef(512,TextEditorModule,TextEditorModule,[]),__chunk1_js.moduleProvideDef(1024,__chunk1_js.ROUTES,function(){return[[{path:"",component:TextEditor}]]},[])])});exports.TextEditorModuleNgFactory=TextEditorModuleNgFactory;
